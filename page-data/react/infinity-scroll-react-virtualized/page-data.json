{"componentChunkName":"component---src-templates-post-template-tsx","path":"/react/infinity-scroll-react-virtualized/","result":{"data":{"posts":{"edges":[{"node":{"fields":{"slug":"/react/infinity-scroll-react-virtualized/"},"html":"<blockquote>\n<p>다른 사이트에서 블로그를 운영할 때 작성한 글을 이전했습니다. 🙂</p>\n</blockquote>\n<h2>들어가며</h2>\n<p>React 공식 문서에서 소개하는 <strong>react-virtualized 라이브러리를 사용한 무한 스크롤 최적화</strong> 포스팅입니다. <strong>windowing 기법</strong>과 <strong>크롬 개발자 도구를 활용한 성능 측정 방법</strong>에 대해 먼저 알아본 후 react-virtualized 라이브러리 사용 방법을 소개합니다.</p>\n<h2>1. react-virtualized 가 무엇인가요?</h2>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 768px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/93c159303577b0c7c97d3bdfcc8c2c50/79e31/react-virtualized-1.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 45.833333333333336%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAYAAAAywQxIAAAACXBIWXMAAAsTAAALEwEAmpwYAAABlklEQVQoz5WR227aQBRF/TUtaVAgAVIpRVVf+tQPbxI1ECdKgBfAF5gxNhd7PHa42KtiUujtKSNtnZlzdLbW1liVaoPal2/U2l+pfKhTOb2g2mxz2vpM47LN2flHLpqfqNYuOW9e0Wi1eX9S512lRrXWMjLvk7qp1tNzj679wO2PDt17m7u7Dp3HJ+zeAPvhkV5/8Kre4I97n+de/+/ZL1mUBaPRkOvr7/i+T/e+y+3NDXa3Y5beeqzNZs1qFZOqFK01SZKglELr1PQXyyVJEpOmqZnF8et8MZ+jdUZZlux2O4qiMLLyPMdzPVzHwXEcpBBMp1N832MymeB7Ho4zxvN8xqMRY8cxSaSUxKvYUO1Nj4S7okDpnJVSKK2JU43OX0iVIokTsjxHZ9ok2Pd0mpJl2ZHoYHao1nq9xp+FeFLiTQV+EDHyJoSzECEFgZQIIZBCGuIgCAzdnnIV/yY8Gu4ju47LcDjEd12WiwVBIImiOcEsIIpCwjAkjA6KCGczhJCoRP0feY+92WzYbreURfHmX/038k+8In5oIXPEAwAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/93c159303577b0c7c97d3bdfcc8c2c50/a59e9/react-virtualized-1.webp 192w,\n/static/93c159303577b0c7c97d3bdfcc8c2c50/0ca9f/react-virtualized-1.webp 384w,\n/static/93c159303577b0c7c97d3bdfcc8c2c50/dc9b9/react-virtualized-1.webp 768w,\n/static/93c159303577b0c7c97d3bdfcc8c2c50/2bbcb/react-virtualized-1.webp 951w\"\n              sizes=\"(max-width: 768px) 100vw, 768px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/93c159303577b0c7c97d3bdfcc8c2c50/3b721/react-virtualized-1.png 192w,\n/static/93c159303577b0c7c97d3bdfcc8c2c50/66595/react-virtualized-1.png 384w,\n/static/93c159303577b0c7c97d3bdfcc8c2c50/fe486/react-virtualized-1.png 768w,\n/static/93c159303577b0c7c97d3bdfcc8c2c50/79e31/react-virtualized-1.png 951w\"\n            sizes=\"(max-width: 768px) 100vw, 768px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/93c159303577b0c7c97d3bdfcc8c2c50/fe486/react-virtualized-1.png\"\n            alt=\"react-virtualized-1\"\n            title=\"react-virtualized-1\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n  </a>\n    </span></p>\n<p>react-virtualized 란 React 공식 문서 <a href=\"https://ko.reactjs.org/docs/optimizing-performance.html\" target=\"_blank\" rel=\"nofollow\">성능 최적화 페이지</a>에서 소개하는 두 개의 라이브러리 중 하나입니다.</p>\n<blockquote>\n<p>react-virtualized 를 널리 알려진 windowing 라이브러리라고 소개하고 있습니다.</p>\n</blockquote>\n<p>여기서 <strong>windowing 기법</strong>이란 무엇일까요?</p>\n<p>React 공식 문서에는 이렇게 적혀 있습니다.</p>\n<blockquote>\n<p>주어진 시간에 목록의 부분 목록만 렌더링하며 컴포넌트를 다시 렌더링하는 데 걸리는 시간과 생성된 DOM 노드의 수를 크게 줄일 수 있습니다.</p>\n</blockquote>\n<p>windowing 기법에 대해 조금 더 자세히 알아보겠습니다.</p>\n<h3>1-1. windowing 기법</h3>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 768px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/78edfe551cdefc6d39b713398b0cc22a/bbbf7/react-virtualized-2.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 57.29166666666667%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAIAAADwazoUAAAACXBIWXMAAAsTAAALEwEAmpwYAAABoElEQVQoz22QXW/TMBSG9///AFxxwW7YEBKCCU3VpnZtk1G0LaRqlsRxbNfLV/PRQmMvS0JyUJNRDeh7YR0d+fF5jo8AoG1bAIiiaHB+fjEYpEkspWyaBgDCeHVp34xcbXA/GxFtaN4IKeBPjnZwV+VSflBnrz+dLQhNkyQIw92LaaLyxbVvjt3vXwPzmi6klH/BfVqASy969U1XXPqrKtlyCQCrNBkzXXlYDPGd4hlTVxf/w5046Kvszdw+vZsHYZgkSQ9P2VzxjJGrqf79lOj/au/X9tPs9GL48Wr8c5v3/ThLrxxtQvSRfTuh+gRpj8XjAW0AKJ+evpx9fn/yjlH63Kkq6nGXM7ykLmc88PoxB2AAUFT17fHxbDbrdeq69j2Pc84Ye+A8iqK2y2FYCBEEQZZl+3WklEKIPM+FEEVRvLy8g8uyxBhTSk3TtG2bEOL7PkLIcRyMMWPMsiyEkGVZrusahmHbdlmWz3BVVZsuP7oEQYAQIoRgjPvCcZw4jjebzXq9TtM0y7K6rg9oA0DTNNvttrftz6IoXv7TXvs3Jotg0aLrtD4AAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/78edfe551cdefc6d39b713398b0cc22a/a59e9/react-virtualized-2.webp 192w,\n/static/78edfe551cdefc6d39b713398b0cc22a/0ca9f/react-virtualized-2.webp 384w,\n/static/78edfe551cdefc6d39b713398b0cc22a/dc9b9/react-virtualized-2.webp 768w,\n/static/78edfe551cdefc6d39b713398b0cc22a/e2c2f/react-virtualized-2.webp 1152w,\n/static/78edfe551cdefc6d39b713398b0cc22a/94b1e/react-virtualized-2.webp 1280w\"\n              sizes=\"(max-width: 768px) 100vw, 768px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/78edfe551cdefc6d39b713398b0cc22a/3b721/react-virtualized-2.png 192w,\n/static/78edfe551cdefc6d39b713398b0cc22a/66595/react-virtualized-2.png 384w,\n/static/78edfe551cdefc6d39b713398b0cc22a/fe486/react-virtualized-2.png 768w,\n/static/78edfe551cdefc6d39b713398b0cc22a/d2d74/react-virtualized-2.png 1152w,\n/static/78edfe551cdefc6d39b713398b0cc22a/bbbf7/react-virtualized-2.png 1280w\"\n            sizes=\"(max-width: 768px) 100vw, 768px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/78edfe551cdefc6d39b713398b0cc22a/fe486/react-virtualized-2.png\"\n            alt=\"react-virtualized-2\"\n            title=\"react-virtualized-2\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n  </a>\n    </span></p>\n<p><em>사진 출처: <a href=\"https://www.patterns.dev/posts/virtual-lists/\" target=\"_blank\" rel=\"noreferrer noopener\" aria-label=\"sitemap-vs-website\">patterns.dev</a></em></p>\n<p>많은 데이터를 list 로 만들고 초기 렌더링에 모든 데이터를 불러오려면 굉장히 오랜 시간이 걸립니다. 사용자로서 긴 렌더링 시간이 불편하게 느껴질 수 있습니다.</p>\n<blockquote>\n<p>이를 해결하기 위해서 <strong>list 중 viewport 에 보이는 부분만 렌더링하고 나머지는 스크롤 할 때 보이도록 하는 것</strong>을 권장합니다.</p>\n</blockquote>\n<p>그리고 이 방법을 windowing 기법이라고 합니다.</p>\n<h3>1-2. react-virtualized 를 선택한 이유</h3>\n<p>위에서 react-virtualized 에 대해 작성할 때 React 공식 문서에서 소개하는 두 개의 라이브러리 중 하나라고 했는데, 다른 하나는 react-window 라이브러리입니다. 이 포스팅에서 react-window 가 아닌 react-virtualized 를 다루는 이유는 다음과 같습니다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 768px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/22034c1690e811b6ed9991e23603c846/03d4c/react-virtualized-3.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 86.45833333333334%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAARCAIAAABSJhvpAAAACXBIWXMAAA7DAAAOwwHHb6hkAAABv0lEQVQ4y5VTSW4cMQyc/78jnwiSB+Sco+HccpixZ3GrJe5FBWp1JjacBSEajRIlUkWydGC1pZKIEFFm9v+xg6qez+fL5XI8nU6np3Vd9+Xx2Fr7R3AEKnFtVNamQnBz04hwdwD5Vzuw4Xnhp4UvhWx9tnJOrREBwH2kiM0mmP9fwe5eylJKEREWKWVlljux9z147TkkMJNtO2PVE1VRSMMd7eomiPh9zQBUNTMlkhTiKZ4vHIV9YSciEi/sReKFYpVoGjcKdfSehxEmulA0RRt7IAMbVkFkJ+/Ne+Tg1DOrZlMEsPAWDEBEsNEeJ0ZRoxk9I427jy+tgUtK6dpSa3IplQJ93Kwi2LzbiTVl3YELjNMkw/b+hiGsJ7QtbNhvzuHKu8Jegfft3jiGpPO42cymHO4zHABIjEnsYLPpmXDM+bViVBVA7111iGyCedDMZuo72EXCRG955Vvm+SfJHJCpPpLjJ+F1vbl7ayVCmbnW2ntvtTJVd1+WxQMxaZvH8VqrxK35yLJpZivNZyFjFnOcwPV6/fzp44cvD+c55w5PutKmkBzyxHhPmYhRvLmPdu5NBRF9e3z8+v2iYzN/APJq5tg5jDr3AAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/22034c1690e811b6ed9991e23603c846/a59e9/react-virtualized-3.webp 192w,\n/static/22034c1690e811b6ed9991e23603c846/0ca9f/react-virtualized-3.webp 384w,\n/static/22034c1690e811b6ed9991e23603c846/dc9b9/react-virtualized-3.webp 768w,\n/static/22034c1690e811b6ed9991e23603c846/e2c2f/react-virtualized-3.webp 1152w,\n/static/22034c1690e811b6ed9991e23603c846/f80fb/react-virtualized-3.webp 1266w\"\n              sizes=\"(max-width: 768px) 100vw, 768px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/22034c1690e811b6ed9991e23603c846/3b721/react-virtualized-3.png 192w,\n/static/22034c1690e811b6ed9991e23603c846/66595/react-virtualized-3.png 384w,\n/static/22034c1690e811b6ed9991e23603c846/fe486/react-virtualized-3.png 768w,\n/static/22034c1690e811b6ed9991e23603c846/d2d74/react-virtualized-3.png 1152w,\n/static/22034c1690e811b6ed9991e23603c846/03d4c/react-virtualized-3.png 1266w\"\n            sizes=\"(max-width: 768px) 100vw, 768px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/22034c1690e811b6ed9991e23603c846/fe486/react-virtualized-3.png\"\n            alt=\"react-virtualized-3\"\n            title=\"react-virtualized-3\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n  </a>\n    </span></p>\n<blockquote>\n<p>react-virtualized 사용자</p>\n</blockquote>\n<p>위 사진은 최근 6개월 동안 react-virtualized 와 react-window 의 다운로드 횟수를 나타낸 것입니다. react-virtualized 패키지의 사용자가 더 많은 것을 확인할 수 있습니다. 또한, react-virtualized 에는 react-window 에 없는 기능이 있는데 그중 두 가지는 아래와 같습니다.</p>\n<blockquote>\n<p>window 스크롤</p>\n</blockquote>\n<p>react-window 는 컨테이너의 너비와 높이를 명시적으로 지정하여 해당 컨테이너 내에서만 가상화가 가능합니다. react-virtualized 의 WindowScroller 컴포넌트를 사용하면 페이스북이나 트위터처럼 <strong>window 스크롤을 기준으로 목록이 가상화되도록 구현</strong>할 수 있습니다.</p>\n<blockquote>\n<p>요소의 동적인 height 측정</p>\n</blockquote>\n<p>콘텐츠형 광고 페이지 내에서 렌더링 되는 요소의 <code>height</code>값은 요소의 내용에 따라 변하기 때문에 동적인 <code>height</code>을 측정할 수 있어야 합니다. react-window 는 요소의 동적인 <code>height</code>값을 측정할 방법이 없지만, react-virtualized 에서 <code>CellMeasurer</code>라는 컴포넌트는 <strong>원하는 요소의 동적인 height 값을 측정</strong>해주는 역할을 담당하고 있습니다. 동적인 height 값에 대해서는 <a href=\"http://bvaughn.github.io/react-virtualized/##/components/List\" target=\"_blank\" rel=\"nofollow\">react-virtualized</a> 링크에서 확인할 수 있습니다.</p>\n<blockquote>\n<p>그러나 위 사진의 size 항목에서 확인할 수 있는 거처럼 react-window 가 react-virtualized 보다 훨씬 작아서 추가적인 기능을 사용하지 않는다면 react-window 사용을 권장하기도 합니다.</p>\n</blockquote>\n<h2>2. 크롬 개발자 도구로 성능 측정하는 방법</h2>\n<p>성능을 분석해야 할 때는 느려졌다는 느낌이 아니라 정확히 몇 초가 걸리는지 확인이 필요합니다. 크롬 개발자 도구의 <strong>Performance 탭</strong>으로 이를 측정할 수 있습니다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 768px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/fd14d6b4a43b1e9a86649c26d28b26e5/ac7a9/react-virtualized-4.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 48.958333333333336%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAYAAAC0VX7mAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAB3UlEQVQoz42Ry27UMBhG57nY8AR9G5bs2PIOsOCyZdMNm4JQu4C2o4JQr5DpNLdxHMdJJnESOznImQq1CyQsHdn6F8efPy82mSJWFWFRk5TbmUhvCfOSjSxIhCQVKUIKlIyJojvSKCBLAtI4Ig5j4jAijmLCMGShlObZxyOevtln790+e2/3efLqA88/nyBzPQsTuSHJU7S4RudXSHmJyq+5TRJ+RzFBnBBEIeu7NQuf4uuPc46OlxzOnHL47ZTzq1/3CRX1tmMYJnoHWm1I198p0kvKeEmVLCnjE2p5Q2sGFmlWoMsKpomHq29akiwnlSW1cVRNT2NhfXHA+cFLwuPX3H55MbP69Jzo7D1Va3cJZa5o2pZ+sHT9wDAM1GVFkimELFgltwQiIFIhK3nBTbpkJU4JsjNW2RmBWLLa/GSjBItUFuSFxnQd1joGa3HWsa3qWSiVpmkbrLOMo8O6kd6Cf884PabrzC6hyCStMbhxxDrH6ByNTyhylK4eVTFOE4Mb8crJ1zTd776mvt91mCvNtmlpTU9jOozpKXU1f4hU5S61czP+wn5wjOP4Fz/3uzHGC9X8m17sz48pEFJRaE3XdXMCa+0/8d0vdjIv3Ykf4udZXrCta5qm+S/+ABDk7zTUHyGGAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/fd14d6b4a43b1e9a86649c26d28b26e5/a59e9/react-virtualized-4.webp 192w,\n/static/fd14d6b4a43b1e9a86649c26d28b26e5/0ca9f/react-virtualized-4.webp 384w,\n/static/fd14d6b4a43b1e9a86649c26d28b26e5/dc9b9/react-virtualized-4.webp 768w,\n/static/fd14d6b4a43b1e9a86649c26d28b26e5/e2c2f/react-virtualized-4.webp 1152w,\n/static/fd14d6b4a43b1e9a86649c26d28b26e5/f3efb/react-virtualized-4.webp 1536w,\n/static/fd14d6b4a43b1e9a86649c26d28b26e5/0b34d/react-virtualized-4.webp 1920w\"\n              sizes=\"(max-width: 768px) 100vw, 768px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/fd14d6b4a43b1e9a86649c26d28b26e5/3b721/react-virtualized-4.png 192w,\n/static/fd14d6b4a43b1e9a86649c26d28b26e5/66595/react-virtualized-4.png 384w,\n/static/fd14d6b4a43b1e9a86649c26d28b26e5/fe486/react-virtualized-4.png 768w,\n/static/fd14d6b4a43b1e9a86649c26d28b26e5/d2d74/react-virtualized-4.png 1152w,\n/static/fd14d6b4a43b1e9a86649c26d28b26e5/e8464/react-virtualized-4.png 1536w,\n/static/fd14d6b4a43b1e9a86649c26d28b26e5/ac7a9/react-virtualized-4.png 1920w\"\n            sizes=\"(max-width: 768px) 100vw, 768px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/fd14d6b4a43b1e9a86649c26d28b26e5/fe486/react-virtualized-4.png\"\n            alt=\"react-virtualized-4\"\n            title=\"react-virtualized-4\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n  </a>\n    </span></p>\n<p>녹화 버튼을 클릭한 후, 할 일 목록에 체크하고 화면에 변화가 반영되면 Stop 버튼을 누릅니다.</p>\n<blockquote>\n<p>성능 분석 결과에 나타나는 Timings 를 열어 보면 각 시간대에 컴포넌트의 어떤 작업이 처리되었는지 확인할 수 있습니다.</p>\n</blockquote>\n<p>App [update] 박스를 열어 작업 처리 시간을 확인했습니다. 2500개의 데이터가 있는데 1.4초가 걸린다는 것은 성능이 매우 나쁘다는 의미입니다. 최적화를 한 이후 이 성능을 비교해보겠습니다.</p>\n<h2>3. react-virtualized 사용 방법</h2>\n<h3>3-1. 패키지 설치</h3>\n<p>우선 yarn 을 통해 react-virtualized 를 설치하겠습니다.</p>\n<deckgo-highlight-code language=\"shell\" terminal=\"carbon\" theme=\"seti\"  >\n          <code slot=\"code\">yarn add react-virtualized</code>\n        </deckgo-highlight-code>\n<p>이제 react-virtualized 에서 제공하는 List 컴포넌트를 사용하여 To Do List 컴포넌트 성능 최적화를 하겠습니다.</p>\n<h3>3-2. 각 항목의 px 단위 측정하기</h3>\n<p>최적화를 수행하기 전에 필요한 작업은 각 항목의 실제 크기를 px 단위로 알아내는 것입니다. <strong>크롬 개발자 도구</strong>를 통해 이 크기를 쉽게 알아낼 수 있습니다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 768px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/798b813fcd11943eed872dd58db10434/ac7a9/react-virtualized-5.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 48.958333333333336%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAYAAAC0VX7mAAAACXBIWXMAAA7DAAAOwwHHb6hkAAABx0lEQVQoz32SS24UMRBA52LsOACchh13gU1YwAIFRIJQNMqOj2A1QihsUGYy/fOv3W13t+1+yD1RMiBESSVblvXqVdmrspbsZMu1stzojr3u2OYUhqKW1ELR1IreeYbB472n73uKskIqhZSKphFUZY0QgpUQmicfPvLw5IzHL854dPKOB89OeXr5jbpRCNXijMUoi3OeGAMxBFpj6KxdiuRIKS2FVpXQrD995uX5e07XF7y9XPNmfcHXzYayVghtGZynLiVSdozTRAJ6KdFNwxQjaZ4XoHOOVdUofu62XBUVW63ZasO1UhRNvQBr1WI7z75Q7PYGYx0+zPTW4p2DmEghMI7jwbCoFUoZwjQxp5kUE6SZvu24qQTSWMLgEaWkKgyDzy3OxHx37Pjx5TnX318vbQ/jyKrIc5IK5wemXGkKy2pby/4WOHlPUwiKvV6s5vkAJHh+bV5RXJ3fA8tGUdUNzntiSoQ8kxjpTXsw1JbpyDC/8gzEGPk7xsUwD15qut7h/EjvB7wfMbo9GOpbw1JSZkPv/gBm25xHQEm2zOC8v8tGsa/kPbAQd0D+BzzAMvQAPs58LnS7AGWlqEqzAPMXCSH8E/gbO6z2ipsX4/AAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/798b813fcd11943eed872dd58db10434/a59e9/react-virtualized-5.webp 192w,\n/static/798b813fcd11943eed872dd58db10434/0ca9f/react-virtualized-5.webp 384w,\n/static/798b813fcd11943eed872dd58db10434/dc9b9/react-virtualized-5.webp 768w,\n/static/798b813fcd11943eed872dd58db10434/e2c2f/react-virtualized-5.webp 1152w,\n/static/798b813fcd11943eed872dd58db10434/f3efb/react-virtualized-5.webp 1536w,\n/static/798b813fcd11943eed872dd58db10434/0b34d/react-virtualized-5.webp 1920w\"\n              sizes=\"(max-width: 768px) 100vw, 768px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/798b813fcd11943eed872dd58db10434/3b721/react-virtualized-5.png 192w,\n/static/798b813fcd11943eed872dd58db10434/66595/react-virtualized-5.png 384w,\n/static/798b813fcd11943eed872dd58db10434/fe486/react-virtualized-5.png 768w,\n/static/798b813fcd11943eed872dd58db10434/d2d74/react-virtualized-5.png 1152w,\n/static/798b813fcd11943eed872dd58db10434/e8464/react-virtualized-5.png 1536w,\n/static/798b813fcd11943eed872dd58db10434/ac7a9/react-virtualized-5.png 1920w\"\n            sizes=\"(max-width: 768px) 100vw, 768px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/798b813fcd11943eed872dd58db10434/fe486/react-virtualized-5.png\"\n            alt=\"react-virtualized-5\"\n            title=\"react-virtualized-5\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n  </a>\n    </span></p>\n<p>각 항목의 크기는 가로 <code>495px</code>, 세로 <code>57px</code>입니다. 여기서 첫 번째 항목이 아니라 두 번째 항목을 확인하는 이유는 테두리가 포함된 값을 알아내기 위해서입니다.</p>\n<h3>3-3. 코드 수정하기</h3>\n<blockquote>\n<p>예시 코드 구조</p>\n</blockquote>\n<deckgo-highlight-code  terminal=\"carbon\" theme=\"seti\"  >\n          <code slot=\"code\">src\n ┣ components\n ┃ ┣ TodoInsert.js\n ┃ ┣ TodoInsert.scss\n ┃ ┣ TodoList.js\n ┃ ┣ TodoList.scss\n ┃ ┣ TodoListItem.js\n ┃ ┣ TodoListItem.scss\n ┃ ┣ TodoTemplate.js\n ┃ ┗ TodoTemplate.scss\n ┣ App.css\n ┣ App.js\n ┣ App.test.js\n ┣ index.css\n ┣ index.js\n ┣ logo.svg\n ┗ serviceWorker.js</code>\n        </deckgo-highlight-code>\n<blockquote>\n<p>수정 전 To Do List 코드</p>\n</blockquote>\n<deckgo-highlight-code language=\"js\" terminal=\"carbon\" theme=\"seti\"  >\n          <code slot=\"code\">import React from &#39;react&#39;;\nimport TodoListItem from &#39;./TodoListItem&#39;;\nimport &#39;./TodoList.scss&#39;;\n\nconst TodoList = ({ todos, onRemove, onToggle }) =&gt; {\n  return (\n    &lt;div className=&quot;TodoList&quot;&gt;\n      {todos.map(todo =&gt; (\n        &lt;TodoListItem\n          todo={todo}\n          key={todo.id}\n          onRemove={onRemove}\n          onToggle={onToggle}\n        /&gt;\n      ))}\n    &lt;/div&gt;\n  );\n};\n\nexport default TodoList;</code>\n        </deckgo-highlight-code>\n<blockquote>\n<p>react-virtualized 를 적용한 To Do List 코드</p>\n</blockquote>\n<ul>\n<li>\n<p><code>useCallback</code>과 <code>memo</code>로 최적화를 한 이후에 react-virtualized 를 적용한 코드입니다.</p>\n</li>\n<li>\n<p>react-virtualized 관련 내용은 <code>return</code>문의 <code>List</code>컴포넌트입니다.</p>\n</li>\n</ul>\n<deckgo-highlight-code language=\"js\" terminal=\"carbon\" theme=\"seti\"  >\n          <code slot=\"code\">import React, { useCallback } from &#39;react&#39;;\nimport { List } from &#39;react-virtualized&#39;;\nimport TodoListItem from &#39;./TodoListItem&#39;;\nimport &#39;./TodoList.scss&#39;;\n\nconst TodoList = ({ todos, onRemove, onToggle }) =&gt; {\n  const rowRenderer = useCallback(\n    ({ index, key, style }) =&gt; {\n      const todo = todos[index];\n      return (\n        &lt;TodoListItem\n          todo={todo}\n          key={key}\n          onRemove={onRemove}\n          onToggle={onToggle}\n          style={style}\n        /&gt;\n      );\n    },\n    [onRemove, onToggle, todos],\n  );\n  return (\n    &lt;List\n      className=&quot;TodoList&quot;\n      width={495} // 전체 크기\n      height={513} // 전체 높이\n      rowCount={todos.length} // 항목 개수\n      rowHeight={57} // 항목 높이\n      rowRenderer={rowRenderer} // 항목을 렌더링할 때 쓰는 함수\n      list={todos} // 배열\n      style={{ outline: &#39;none&#39; }} // List에 기본 적용되는 outline 스타일 제거\n    /&gt;\n  );\n};\n\nexport default React.memo(TodoList);</code>\n        </deckgo-highlight-code>\n<p><code>List</code>컴포넌트를 사용하기 위해 <code>rowRenderer</code>라는 함수를 새로 작성했습니다. 이 함수는 react-virtualized 의 <code>List</code>컴포넌트에서 각 To Do Item을 렌더링할 때 사용하며, 이 함수를 <code>List</code>컴포넌트의 <code>props</code>값으로 설정해야 합니다. 이 함수는 파라미터에 <code>index</code>, <code>key</code>, <code>style</code>값을 객체 타입으로 받아 와서 사용합니다.</p>\n<blockquote>\n<p>List 컴포넌트를 사용할 때는 <strong>해당 리스트의 전체 크기와 각 항목의 높이, 각 항목을 렌더링할 때 사용해야 하는 함수, 그리고 배열</strong>을 <code>props</code>로 넣어 주어야 합니다.</p>\n</blockquote>\n<p>그러면 이 컴포넌트가 전달받은 <code>props</code>를 사용하여 자동으로 최적화를 해줍니다.</p>\n<h3>3-4. 최적화 이후 성능 비교</h3>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 768px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/b9da5d9fa76c8de87822aeb39bd80e07/ac7a9/react-virtualized-6.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 48.958333333333336%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAYAAAC0VX7mAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAB2UlEQVQoz32Ry27UMBSG58XY8AR9HDas2PEYLBCsWZQFSG1ZQKvCAlCl3ieZSTIzuTiZ+BI7Tj7kpIIuAEu/dHzs8/s7x4tNXpFVe9K6ZVNLNo0krSVp2bAtBNm2YLVakSQJWZZxcxdxv4yI4yXrdcinv7VOEhaianj24ZSnrw85ePuegzeHPHn1jucn3yiqmnSbs1xFRElElK5Ypmtu0xXXScz1eslVdMUymCcJURyz2JU1X75fcHL2ddLx6TlHn8/4eXlDOEt3gkYZdD9S5AnRxTHRxRHZ3Tki/YHULdoNGDsglWGxyQV1s4dx5PFyxrAJLec10nhUN1C3hvT6IzefXhCdvqQqUvbSoDuwDpS2s2FRCZQ2WNfTWYftLO1esi1qNruCpqmQStF2BgUIq8mbNbp3yKbjPrslrmJ29Y5FoCgrgTEdfe9xvad3DtnKiTAvBW3b4r2f0ccB7wf6sH3oqnMG4xRSSxbhJ3dFiTEGP4SLHu8cKhjmglLsQyV/BjLih5Hez5nx0aisnVquKEWNVBrTWXRnJ9qmaQlnRdXMjzxomB4dsP0cB/lhjgPURBgK/65AXyFETWfMRND3/T/lnJsJg+lj4+1DLsRhhrJt0VpPUkr9V78Ajb7yqhtNDPgAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/b9da5d9fa76c8de87822aeb39bd80e07/a59e9/react-virtualized-6.webp 192w,\n/static/b9da5d9fa76c8de87822aeb39bd80e07/0ca9f/react-virtualized-6.webp 384w,\n/static/b9da5d9fa76c8de87822aeb39bd80e07/dc9b9/react-virtualized-6.webp 768w,\n/static/b9da5d9fa76c8de87822aeb39bd80e07/e2c2f/react-virtualized-6.webp 1152w,\n/static/b9da5d9fa76c8de87822aeb39bd80e07/f3efb/react-virtualized-6.webp 1536w,\n/static/b9da5d9fa76c8de87822aeb39bd80e07/0b34d/react-virtualized-6.webp 1920w\"\n              sizes=\"(max-width: 768px) 100vw, 768px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/b9da5d9fa76c8de87822aeb39bd80e07/3b721/react-virtualized-6.png 192w,\n/static/b9da5d9fa76c8de87822aeb39bd80e07/66595/react-virtualized-6.png 384w,\n/static/b9da5d9fa76c8de87822aeb39bd80e07/fe486/react-virtualized-6.png 768w,\n/static/b9da5d9fa76c8de87822aeb39bd80e07/d2d74/react-virtualized-6.png 1152w,\n/static/b9da5d9fa76c8de87822aeb39bd80e07/e8464/react-virtualized-6.png 1536w,\n/static/b9da5d9fa76c8de87822aeb39bd80e07/ac7a9/react-virtualized-6.png 1920w\"\n            sizes=\"(max-width: 768px) 100vw, 768px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/b9da5d9fa76c8de87822aeb39bd80e07/fe486/react-virtualized-6.png\"\n            alt=\"react-virtualized-6\"\n            title=\"react-virtualized-6\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n  </a>\n    </span></p>\n<blockquote>\n<p>최적화 이전에는 1.4초가 걸렸지만, 최적화 이후 11ms(0.011초) 가 걸리는 것을 확인할 수 있습니다. 👍</p>\n</blockquote>\n<p>현재 다룬 예시는 react-virtualized 만 적용했을 때 최적화 성능은 아니지만, 다른 예시를 통해 최적화 적용 순서대로 성능을 측정했을 때는 다음과 같습니다.</p>\n<ul>\n<li>\n<p>최적화 적용 전 코드: 1.02초</p>\n</li>\n<li>\n<p>React.memo 적용 코드: 0.059초</p>\n</li>\n<li>\n<p>react-virtualized 적용 코드: 0.005초</p>\n</li>\n</ul>\n<h2>마치며</h2>\n<p>react-virtualized 사용 방법에 대해 알아봤습니다. 리액트 컴포넌트의 렌더링은 기본적으로 빨라서 컴포넌트를 개발할 때 최적화 작업에 대해 너무 큰 스트레스를 받거나 모든 컴포넌트에 일일이 React.memo 를 작성할 필요는 없습니다. 단, 리스트와 관련된 컴포넌트를 만들 때 보여 줄 항목이 100개 이상이고 업데이트가 자주 발생한다면, 최적화가 필요합니다.</p>\n<hr>\n<p>참고 자료 📩</p>\n<ul>\n<li><a href=\"https://ko.reactjs.org/docs/optimizing-performance.html\" target=\"_blank\" rel=\"nofollow\">성능 최적화 – React</a></li>\n<li><a href=\"https://book.naver.com/bookdb/book_detail.nhn?bid=15372757\" target=\"_blank\" rel=\"nofollow\">리액트를 다루는 기술 : 네이버 도서</a></li>\n<li><a href=\"https://blog.bitsrc.io/10-ways-to-optimize-your-react-apps-performance-e5e437c9abce\" target=\"_blank\" rel=\"nofollow\">10 Ways to Optimize Your React App’s Performance | by Chidume Nnamdi 🔥💻🎵🎮 | Bits and Pieces</a></li>\n</ul>","timeToRead":6,"frontmatter":{"title":"react-virtualized를 사용한 무한 스크롤 최적화","summary":"react-virtualized 라이브러리를 사용한 무한 스크롤 최적화 방법입니다. windowing 기법과 개발자 도구를 활용한 성능 측정 방법도 포함하고 있습니다.","date":"2021-05-30","category":"React","thumbnail":{"publicURL":"/static/75e8b2967b671eb51bc34baa55119313/infinity-scroll-react-virtualized.png"}}}}]}},"pageContext":{"slug":"/react/infinity-scroll-react-virtualized/"}},"staticQueryHashes":["1663765485","2170400879","3026479947","4290078607"]}